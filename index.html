<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒ¸ è¨‚å–®ç®¡ç†ç³»çµ± (Internia Style)</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="shell">
  
  <div class="shell-tabs">
    <div style="padding: 0 20px 10px 20px; font-size: 12px; color: #aaa; font-weight: 700;">MENU</div>

    <button class="shell-tab active" onclick="switchTab('pay-sub-orders', this)">
        ğŸ“¦ è¨‚å–®åˆ—è¡¨
    </button>
    
    <button class="shell-tab" onclick="switchTab('pay-sub-add', this)">
        â• æ–°å¢è¨‚å–®
    </button>
    
    <button class="shell-tab" onclick="switchTab('pay-sub-import', this)">
        ğŸ“„ æ‰¹é‡åŒ¯å…¥
    </button>
    
    <button class="shell-tab" onclick="switchTab('pay-sub-calc', this)">
        ğŸ“… æŸ¥è©¢æ’¥æ¬¾æ—¥
    </button>
    
    <button class="shell-tab" onclick="switchTab('panel-sms', this)">
        ğŸ“± SMS å®¢æˆ¶é€šçŸ¥
    </button>
  </div>

  <div class="shell-content">
    
    <!-- ========== è¨‚å–®åˆ—è¡¨ ========== -->
    <div id="pay-sub-orders" class="shell-panel active">
      
      <div class="shell-header" style="margin: -40px -40px 30px -40px; border-radius: 24px 24px 0 0; padding: 30px 40px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2 style="margin:0; font-size:24px;">è¨‚å–®åˆ—è¡¨</h2>
            
            <div style="display: flex; gap: 20px; font-size: 14px; font-weight: 600;">
                <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
                    <input type="radio" name="statusFilter" value="all" checked onchange="safeRender()"> 
                    å…¨éƒ¨ <span id="cnt-all" style="color:#888;">(0)</span>
                </label>
                <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
                    <input type="radio" name="statusFilter" value="picked" onchange="safeRender()"> 
                    <span style="color:#00b894;">âœ… å·²å–</span> <span id="cnt-picked">(0)</span>
                </label>
                <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
                    <input type="radio" name="statusFilter" value="unpicked" onchange="safeRender()"> 
                    <span style="color:#d63031;">ğŸ“¦ æœªå–</span> <span id="cnt-unpicked">(0)</span>
                </label>
            </div>
        </div>
      </div>

      <!-- â˜…â˜…â˜… ä¿®æ”¹å¾Œçš„æŒ‰éˆ•å€ (ç§»é™¤è¿½è¹¤è²¨æ³) â˜…â˜…â˜… -->
      <div style="margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
         <button class="btn btn-warning" onclick="pushToSMS()">ğŸ“¤ å¸¶å…¥ SMS</button>
         <button class="btn btn-danger" onclick="batchDeleteOrders()">ğŸ—‘ï¸ åˆªé™¤é¸å–</button>
         
<!-- æ–°å¢ï¼šæ‰¹é‡è®¾ç½®åˆ°è´§æ—¥ï¼Œè‡ªåŠ¨ç®—å–è´§æœŸé™ -->
<div class="batch-date-box">
    <span style="font-size:13px; font-weight:700;">ğŸ“¦ æ‰¹é‡è¨­åˆ°è²¨æ—¥ï¼š</span>
    <input type="date" id="batchArriveDate" style="border:none; background:transparent; font-size:13px; width:auto; color: inherit;">
    <button class="btn btn-success btn-sm" onclick="batchSetArriveDate()">å¥—ç”¨ï¼ˆè‡ªå‹•ç®—æœŸé™ï¼‰</button>
</div>
         
         <button class="btn btn-secondary" onclick="exportOrdersExcel()">ğŸ“¥ åŒ¯å‡º Excel</button>
      </div>

      <div class="table-wrap">
        <table id="orderTable">
            <thead>
              <tr>
                <th style="width:40px"><input type="checkbox" id="selectAllPay" onchange="toggleSelectAllPay()"></th>
                <th>è¨‚å–®è™Ÿ</th>
                <th>å§“å</th>
                <th>é›»è©±</th>
                <th>å¹³å°</th>
                <th>å‡ºè²¨æ—¥</th>
                <th>å–è²¨æœŸé™</th>
                <th>ç‰©æµç‹€æ…‹</th>
                <th>ç‹€æ…‹ / æ’¥æ¬¾æ—¥</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody id="payTableBody"></tbody>
        </table>
      </div>
    </div>

    <!-- ========== æ–°å¢è¨‚å–® ========== -->
    <div id="pay-sub-add" class="shell-panel">
      <h2>â• æ–°å¢å–®ç­†è¨‚å–®</h2>
      <div class="pay-form-grid">
        <div>
           <label>è¨‚å–®ç·¨è™Ÿ</label><input type="text" id="addOrderNo" placeholder="#1468">
        </div>
        <div>
           <label>å®¢æˆ¶å§“å</label><input type="text" id="addName" placeholder="ç‹å°æ˜">
        </div>
        <div>
           <label>æ‰‹æ©Ÿè™Ÿç¢¼</label><input type="tel" id="addPhone" placeholder="0912345678">
        </div>
        <div>
           <label>å¹³å°</label>
           <select id="addPlatform">
             <option value="è³£è²¨ä¾¿">è³£è²¨ä¾¿</option>
             <option value="å¥½è³£+">å¥½è³£+</option>
           </select>
        </div>
        <div>
           <label>å‡ºè²¨æ—¥</label><input type="date" id="addShipDate">
        </div>
<div>
   <label>å–è²¨æœŸé™ï¼ˆå¯ç•™ç©ºï¼Œåˆ°è´§åè‡ªåŠ¨ç®—ï¼‰</label><input type="date" id="addDeadline" placeholder="å‡ºè´§æ—¶ä¸ç”¨å¡«ï¼Œåˆ°è´§åä¸€é”®ç”Ÿæˆ">
</div>
        <div>
           <label>ç‰©æµå–®è™Ÿ</label><input type="text" id="addTrackingNum" placeholder="M57607673503">
        </div>
      </div>
      <button class="btn btn-primary" onclick="addNewOrder()">âœ¨ ç¢ºèªæ–°å¢</button>
    </div>

    <!-- ========== æ‰¹é‡åŒ¯å…¥ ========== -->
    <div id="pay-sub-import" class="shell-panel">
       <h2>ğŸ“„ æ‰¹é‡åŒ¯å…¥è¨‚å–®</h2>
       <p style="color:#666; margin-bottom:15px;">è«‹å¾ Excel è¤‡è£½è³‡æ–™ä¸¦ç›´æ¥è²¼ä¸Šï¼Œæ ¼å¼ï¼š<b>è¨‚å–®è™Ÿ | å§“å | é›»è©± | å¹³å° | å‡ºè²¨æ—¥ | å–è²¨æœŸé™ï¼ˆå¯ç•™ç©ºï¼‰ | ç‰©æµå–®è™Ÿ</b></p>
       
       <textarea id="importText" rows="10" placeholder="ä¾‹å¦‚ï¼š
#1001	ç‹å¤§æ˜	0912345678	è³£è²¨ä¾¿	2026/01/20	2026/01/27	M57607673503
#1002	é™³å°ç¾	0987654321	å¥½è³£+	2026/01/21	2026/01/28	F12345678901" 
style="width:100%; padding:15px; border:1px solid #e2e8f0; border-radius:12px; font-family:monospace;"></textarea>
       
       <button class="btn btn-primary" style="margin-top:20px" onclick="importFromText()">ğŸ“¥ é–‹å§‹åŒ¯å…¥</button>
    </div>

    <!-- ========== æŸ¥è©¢æ’¥æ¬¾æ—¥ ========== -->
    <div id="pay-sub-calc" class="shell-panel">
      <h2>ğŸ“… è¨ˆç®—æ’¥æ¬¾æ—¥</h2>
      <div class="pay-form-grid">
         <div>
            <label>é¸æ“‡å¹³å°</label>
            <select id="calcPlatform">
              <option>è³£è²¨ä¾¿</option>
              <option>å¥½è³£+</option>
            </select>
         </div>
         <div>
            <label>å®¢äººå–è²¨æ—¥</label>
            <input type="date" id="calcDate">
         </div>
      </div>
      <button class="btn btn-warning" onclick="doCalc()">è¨ˆç®—</button>
      
      <div id="calcResult" style="margin-top:30px; font-size: 18px; font-weight:bold; color:#00b894; padding: 20px; background: #e0f7fa; border-radius: 12px; display: none;"></div>
    </div>

    <!-- ========== SMS å®¢æˆ¶é€šçŸ¥ ========== -->
    <div id="panel-sms" class="shell-panel">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px;">
          <h2 style="margin:0;">SMS å®¢æˆ¶é€šçŸ¥</h2>
          <div style="font-size:13px; color:#999;">
            <span class="sms-status-dot dot-online" id="smsIndicator"></span> ç³»çµ±ç‹€æ…‹
          </div>
      </div>

      <div class="pay-tabs">
        <div class="pay-tab active" onclick="switchSmsSubTab('list')">ğŸ“¨ å¾…ç™¼é€åå–®</div>
        <div class="pay-tab" onclick="switchSmsSubTab('tpl')">ğŸ’¬ ç¯„æœ¬è¨­å®š</div>
      </div>

      <div id="sms-sub-list" class="pay-panel active">
        <div class="sms-card">
          <label>é¸æ“‡ç°¡è¨Šç¯„æœ¬ï¼š</label>
          <select id="smsTemplateSelect" onchange="previewTemplate()" style="margin-bottom:10px;">
            <option value="">-- è«‹é¸æ“‡ --</option>
          </select>
          <textarea id="smsPreviewBox" rows="3" placeholder="ç°¡è¨Šå…§å®¹é è¦½..." disabled style="background:#f9f9f9;"></textarea>
          <button class="btn btn-primary" style="margin-top:15px; width:100%;" onclick="sendSelectedSMS()">ğŸš€ ç™¼é€é¸å–çš„ç°¡è¨Š</button>
        </div>
        <div id="smsListContainer"></div>
      </div>

      <div id="sms-sub-tpl" class="pay-panel">
         <div class="sms-card" style="background:#fff; border-color:#ffe4e1;">
             <h3 style="margin:0 0 15px 0; font-size:16px; color:#ff6b81;">ğŸ“ ç·¨è¼¯ / æ–°å¢ç¯„æœ¬</h3>
             <label>ç¯„æœ¬åç¨±</label>
             <input type="text" id="tplNameInput" placeholder="ä¾‹å¦‚: å–è²¨é€šçŸ¥" style="margin-bottom:15px;">
             <label>ç°¡è¨Šå…§å®¹ (å¯ç”¨åƒæ•¸: {name} {no} {storeName} {deadline})</label>
             <textarea id="tplContentInput" rows="5" placeholder="è¼¸å…¥ç°¡è¨Šå…§å®¹..."></textarea>
             <div style="margin-top:15px; display:flex; gap:10px;">
                 <button class="btn btn-primary" onclick="saveTemplate()">ğŸ’¾ å„²å­˜</button>
                 <button class="btn btn-secondary" onclick="clearTemplateInput()">å–æ¶ˆ</button>
             </div>
         </div>
         <div id="templateListContainer"></div>
         <button class="btn btn-secondary" style="width:100%; margin-top:20px;" onclick="resetDefaultTemplates()">ğŸ”„ é‡ç½®å›é è¨­ç¯„æœ¬</button>
      </div>

    </div>

  </div>
</div>

<!-- ========== JavaScript ========== -->
<script type="module" src="orders.js"></script>
<script type="module" src="sms.js"></script>

<script>
// ========== Tab åˆ‡æ› ==========
function switchTab(panelId, btn) {
  document.querySelectorAll('.shell-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.shell-tab').forEach(t => t.classList.remove('active'));
  
  document.getElementById(panelId).classList.add('active');
  btn.classList.add('active');
}

// ========== SMS å­åˆ†é åˆ‡æ› ==========
function switchSmsSubTab(sub) {
  document.querySelectorAll('.pay-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.pay-panel').forEach(p => p.classList.remove('active'));
  
  if (sub === 'list') {
    document.querySelector('.pay-tab:nth-child(1)').classList.add('active');
    document.getElementById('sms-sub-list').classList.add('active');
  } else {
    document.querySelector('.pay-tab:nth-child(2)').classList.add('active');
    document.getElementById('sms-sub-tpl').classList.add('active');
  }
}

// ========== å…¨é¸åŠŸèƒ½ ==========
function toggleSelectAllPay() {
  const checked = document.getElementById('selectAllPay').checked;
  document.querySelectorAll('.pay-chk').forEach(cb => cb.checked = checked);
}

// ========== å®‰å…¨æ¸²æŸ“ (é¿å… orders.js æœªè¼‰å…¥) ==========
function safeRender() {
  if (typeof renderPayTable === 'function') {
    renderPayTable();
  } else {
    console.warn('renderPayTable å°šæœªè¼‰å…¥');
  }
}

// ========== è¨ˆç®—æ’¥æ¬¾æ—¥ ==========
function doCalc() {
  const platform = document.getElementById('calcPlatform').value;
  const dateStr = document.getElementById('calcDate').value;
  
  if (!dateStr) {
    alert('è«‹é¸æ“‡å–è²¨æ—¥æœŸï¼');
    return;
  }

  const pickupDate = new Date(dateStr);
  const dow = pickupDate.getDay();
  
  const addDays = (d, n) => {
    const date = new Date(d);
    date.setDate(date.getDate() + n);
    return date;
  };

  const getNextWeekday = (d, target) => {
    const date = new Date(d);
    const current = date.getDay();
    let daysToAdd = target - current;
    if (daysToAdd <= 0) daysToAdd += 7;
    date.setDate(date.getDate() + daysToAdd);
    return date;
  };

  let settlementDate, paymentDate;

  if (platform.includes('è³£è²¨ä¾¿')) {
    if (dow >= 1 && dow <= 3) {
      settlementDate = getNextWeekday(pickupDate, 4);
      paymentDate = addDays(settlementDate, 4);
    } else {
      settlementDate = getNextWeekday(pickupDate, 1);
      paymentDate = addDays(settlementDate, 2);
    }
  } else {
    if (dow >= 1 && dow <= 3) {
      settlementDate = getNextWeekday(pickupDate, 5);
      paymentDate = addDays(settlementDate, 4);
    } else {
      settlementDate = getNextWeekday(pickupDate, 3);
      paymentDate = addDays(settlementDate, 1);
    }
  }

  const resultDiv = document.getElementById('calcResult');
  resultDiv.style.display = 'block';
  resultDiv.innerHTML = `
    ğŸ“… å–è²¨æ—¥: ${dateStr}<br>
    ğŸ’° çµå¸³æ—¥: ${settlementDate.toISOString().split('T')[0]}<br>
    ğŸ’µ æ’¥æ¬¾æ—¥: <span style="color:#d63031; font-size:22px;">${paymentDate.toISOString().split('T')[0]}</span>
  `;
}

// ========== æ–°å¢è¨‚å–® ==========
function addNewOrder() {
  const orderNo = document.getElementById('addOrderNo').value.trim();
  const name = document.getElementById('addName').value.trim();
  const phone = document.getElementById('addPhone').value.trim();
  const platform = document.getElementById('addPlatform').value;
  const shipDate = document.getElementById('addShipDate').value;
  const deadline = document.getElementById('addDeadline').value;
  const trackingNum = document.getElementById('addTrackingNum')?.value.trim() || '';

if (!orderNo || !name || !phone || !shipDate) {
    alert('è«‹å¡«å¯«è¨‚å–®è™Ÿã€å§“åã€é›»è©±ã€å‡ºè²¨æ—¥ï¼');
    return;
}

  if (typeof window.payOrders === 'undefined') {
    alert('ç³»çµ±å°šæœªè¼‰å…¥å®Œæˆï¼Œè«‹ç¨å¾Œå†è©¦');
    return;
  }

  window.payOrders.push({
    no: orderNo,
    name: name,
    phone: phone,
    platform: platform,
    store: '',
    shipDate: shipDate,
    deadline: deadline,
    trackingNum: trackingNum,
    pickupDate: null
  });

  if (typeof savePayOrders === 'function') savePayOrders();
  if (typeof renderPayTable === 'function') renderPayTable();

  // æ¸…ç©ºè¡¨å–®
  document.getElementById('addOrderNo').value = '';
  document.getElementById('addName').value = '';
  document.getElementById('addPhone').value = '';
  document.getElementById('addShipDate').value = '';
  document.getElementById('addDeadline').value = '';
  if (document.getElementById('addTrackingNum')) {
    document.getElementById('addTrackingNum').value = '';
  }

  alert('âœ… æ–°å¢æˆåŠŸï¼');
  switchTab('pay-sub-orders', document.querySelector('.shell-tab'));
}

// ========== æ‰¹é‡åŒ¯å…¥ ==========
function importFromText() {
  if (typeof importFromTextImpl === 'function') {
    importFromTextImpl();
  } else {
    alert('åŒ¯å…¥åŠŸèƒ½å°šæœªè¼‰å…¥');
  }
}

// ========== æ‰¹é‡è¨­ç½®åˆ°è²¨æ—¥ï¼Œè‡ªå‹•ç”Ÿæˆå–è²¨æœŸé™ ==========
function batchSetArriveDate() {
  // 1. å–å¾—é¸æ“‡çš„åˆ°è²¨æ—¥
  const arriveDateVal = document.getElementById('batchArriveDate').value;
  if (!arriveDateVal) {
    alert('âš ï¸ è«‹å…ˆé¸æ“‡åˆ°è²¨æ—¥æœŸï¼');
    return;
  }

  // 2. å–å¾—å‹¾é¸çš„è¨‚å–®
  const checked = Array.from(document.querySelectorAll('.pay-chk:checked'));
  if (checked.length === 0) {
    alert('âš ï¸ è«‹å…ˆå‹¾é¸è¦æ›´æ–°çš„è¨‚å–®ï¼');
    return;
  }

  // 3. ç¢ºèªæ“ä½œ
  if (!confirm(`ç¢ºå®šè¦å°‡ ${checked.length} ç­†è¨‚å–®è¨­ç‚º ${arriveDateVal} åˆ°è²¨ï¼Œä¸¦è‡ªå‹•ç”Ÿæˆå–è²¨æœŸé™å—ï¼Ÿ`)) {
    return;
  }

  // 4. æª¢æŸ¥è¨‚å–®è³‡æ–™
  if (!window.payOrders || !Array.isArray(window.payOrders)) {
    alert('âŒ ç³»çµ±éŒ¯èª¤ï¼šè¨‚å–®è³‡æ–™æœªè¼‰å…¥ï¼Œè«‹é‡æ–°æ•´ç†é é¢');
    return;
  }

  // 5. æ‰¹é‡æ›´æ–°åˆ°è²¨æ—¥å’Œå–è²¨æœŸé™
  let successCount = 0;
  checked.forEach((cb) => {
    let idx = parseInt(cb.dataset.idx || cb.getAttribute('data-idx'));
    const order = window.payOrders[idx];
    if (!order) return;

    // è¨­ç½®åˆ°è²¨æ—¥
    order.arriveDate = arriveDateVal;

    // æŒ‰å¹³å°è‡ªå‹•ç®—å–è²¨æœŸé™ï¼ˆè³£è²¨ä¾¿7å¤©ï¼Œå¥½è³£+5å¤©ï¼‰
    const arriveDateObj = new Date(arriveDateVal);
    let addDays = order.platform === 'è³£è²¨ä¾¿' ? 7 : 7;
    const deadlineObj = new Date(arriveDateObj);
    deadlineObj.setDate(deadlineObj.getDate() + addDays);
    order.deadline = deadlineObj.toISOString().split('T')[0];

    successCount++;
  });

  // 6. å„²å­˜ä¸¦åˆ·æ–°è¡¨æ ¼
  if (typeof savePayOrders === 'function') savePayOrders();
  if (typeof renderPayTable === 'function') renderPayTable();

  // 7. æ¸…ç©ºå‹¾é¸å’Œæ—¥æœŸæ¡†
  document.getElementById('selectAllPay').checked = false;
  document.getElementById('batchArriveDate').value = '';

  // 8. æç¤ºçµæœ
  alert(`âœ… æˆåŠŸè¨­ç½® ${successCount} ç­†è¨‚å–®åˆ°è²¨æ—¥ï¼Œä¸¦è‡ªå‹•ç”Ÿæˆå–è²¨æœŸé™ï¼`);
}



// ========== å–®ç­†ç·¨è¼¯åˆ°è²¨æ—¥ï¼ˆè‡ªå‹•ç®—å–è²¨æœŸé™ï¼‰ ==========
function editOrder(idx) {
  const order = window.payOrders[idx];
  if (!order) return;

  // å½ˆçª—è¼¸å…¥åˆ°è²¨æ—¥
  const newArriveDate = prompt('è¼¸å…¥å¯¦éš›åˆ°è²¨æ—¥ï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼Œä¾‹å¦‚2026-02-06ï¼‰ï¼š', order.arriveDate || '');
  if (newArriveDate === null || !newArriveDate) return;

  // æ›´æ–°åˆ°è²¨æ—¥å’Œå–è²¨æœŸé™
  order.arriveDate = newArriveDate;
  const arriveDateObj = new Date(newArriveDate);
  let addDays = order.platform === 'è³£è²¨ä¾¿' ? 7 : 7;
  const deadlineObj = new Date(arriveDateObj);
  deadlineObj.setDate(deadlineObj.getDate() + addDays);
  order.deadline = deadlineObj.toISOString().split('T')[0];

  // å„²å­˜ä¸¦åˆ·æ–°
  if (typeof savePayOrders === 'function') savePayOrders();
  if (typeof renderPayTable === 'function') renderPayTable();

  alert('âœ… ç·¨è¼¯æˆåŠŸï¼å–è²¨æœŸé™å·²è‡ªå‹•æ›´æ–°');
}

// ========== æ¨é€åˆ° SMS ==========
function pushToSMS() {
  console.log('ğŸš€ pushToSMS è¢«å‘¼å«');
  
  const checked = Array.from(document.querySelectorAll('.pay-chk:checked'));
  
  if (checked.length === 0) {
    alert('âš ï¸ è«‹å…ˆå‹¾é¸è¦é€šçŸ¥çš„è¨‚å–®ï¼');
    return;
  }

  console.log(`ğŸ“¦ å·²å‹¾é¸ ${checked.length} ç­†è¨‚å–®`);

  // æª¢æŸ¥ payOrders æ˜¯å¦å­˜åœ¨
  if (!window.payOrders || !Array.isArray(window.payOrders)) {
    alert('âŒ ç³»çµ±éŒ¯èª¤ï¼šè¨‚å–®è³‡æ–™æœªè¼‰å…¥');
    console.error('payOrders æœªå®šç¾©:', window.payOrders);
    return;
  }

  // å–å¾—è¨‚å–®è³‡æ–™
  const orderList = checked.map(cb => {
    const idx = parseInt(cb.dataset.idx || cb.getAttribute('data-idx'));
    const order = window.payOrders[idx];
    
    if (!order) {
      console.warn(`æ‰¾ä¸åˆ°è¨‚å–®ç´¢å¼• ${idx}`);
      return null;
    }
    
    return {
      no: order.no,
      name: order.name,
      phone: order.phone,
      deadline: order.deadline,
      store: order.store || '',
      platform: order.platform || ''
    };
  }).filter(Boolean); // ç§»é™¤ null å€¼

  console.log('ğŸ“¨ æº–å‚™æ¨é€çš„è¨‚å–®:', orderList);

  // æª¢æŸ¥ SMS å‡½æ•¸æ˜¯å¦å­˜åœ¨
  if (typeof window.receiveOrdersFromPay !== 'function') {
    alert('âŒ SMS åŠŸèƒ½å°šæœªè¼‰å…¥ï¼Œè«‹é‡æ–°æ•´ç†é é¢');
    console.error('receiveOrdersFromPay å‡½æ•¸ä¸å­˜åœ¨');
    return;
  }

  // æ¨é€åˆ° SMS
  window.receiveOrdersFromPay(orderList);
  
  // åˆ‡æ›åˆ° SMS åˆ†é 
  const smsTabs = document.querySelectorAll('.shell-tab');
  if (smsTabs[4]) {
    switchTab('panel-sms', smsTabs[4]);
  }
  
  alert(`âœ… å·²å°‡ ${orderList.length} ç­†è¨‚å–®å¸¶å…¥ SMS å¾…ç™¼é€åå–®`);
}


console.log('âœ… index.html è¼‰å…¥å®Œæˆ');
</script>

</body>
</html>
